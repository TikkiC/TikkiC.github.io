# MedPlatform Dashboard API

Минимальный REST API для нового дэшборда. Работает на Express, по умолчанию использует in-memory хранилище, но готов к подключению реальной базы данных.

Исходные данные подгружаются из файла `../data/pseudo-db.json`, поэтому достаточно обновить этот файл, чтобы синхронизировать фронтенд и API.

## Запуск

```powershell
cd c:\Users\Allorific\Desktop\хакатон\dashboard-api
npm install
npm run dev
```

По умолчанию сервер стартует на порту `4000`.

## Переключение на in-memory / базу данных

- In-memory режим (по умолчанию): просто запускаем сервер без переменных окружения.
- Для явного включения in-memory используйте `USE_MOCK=1`.
- Чтобы подключить реальную БД:
  1. Установите драйвер (PostgreSQL, MongoDB, etc.).
  2. Реализуйте адаптер в `db.js` по примеру в комментариях.
  3. Экспортируйте `DATABASE_URL` в `.env`.

Пример `.env`:

```
PORT=4000
DATABASE_URL=postgres://user:pass@host:5432/medplatform
USE_MOCK=0
```

## Маршруты

| Method | Route                     | Описание                               |
| ------ | ------------------------- | -------------------------------------- |
| GET    | `/api/status`             | Текущее состояние API                  |
| GET    | `/api/metrics`            | Ключевые метрики                       |
| GET    | `/api/trend?range=7`      | Динамика обращений                     |
| GET    | `/api/capacity`           | Загрузка отделений                     |
| GET    | `/api/requests`           | Последние обращения                    |
| POST   | `/api/requests`           | Создание обращения                     |
| PUT    | `/api/requests/:id/status`| Обновление статуса обращения           |
| GET    | `/api/team`               | Команда координаторов и врачей         |
| GET    | `/api/timeline`           | Лента последних событий                |

## Структура состояния

Все данные хранятся в объекте `dashboard` (см. `mockData.js`). Структура закрывает основные потребности фронтенда и легко расширяется.
